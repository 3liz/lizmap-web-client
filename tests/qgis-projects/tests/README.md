# Tests projects

## Project files

In this directory for every test you will find :

* a QGIS project (*.qgs)
* a Lizmap configuration (*.qgs.cfg)
* an optional markdown describing the manual tests scenarios (*.md)

Those files share the same name, only extension is different.

## Data

The PostgreSQL dump (schema + data) `tests_dataset.sql` contains all data to run tests.
* Command to dump (don't forget to remove data generated by running tests before) :
    * `pg_dump -d "service=lizmapdb" -n tests_projects -f tests_dataset.sql`
* Command to restore : `psql service=lizmapdb -f tests_dataset.sql`

## Using another service

*Quick and dirty* process to use these projects on another DB :

* service `qgis_test`
* Lizmap repository `testsrepository`

```bash
./replace_database_connection_qgs_project.sh /home/etienne/dev/lizmap/lizmap-master/tests/qgis-projects/tests/ qgis_test
sudo -u postgres createuser lizmap --superuser
PGPASSWORD=PASSWORD psql -h localhost -p 5432 -U USER -n -d qgis_test -c "DROP SCHEMA IF EXISTS tests_projects CASCADE"
# Change in set_tests_repository_rights.sql the name of the schema, on the first line
PGPASSWORD=PASSWORD psql -h localhost -p 5432 -U USER -d DB_NAME -f set_tests_respository_rights.sql
```